{% extends "chat/base.html" %}

{% load static %}
{% block title %}AI Chat Interface{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'chat/css/chat.css' %}">
{% endblock %}

{% block content %}
<!-- Sidebar toggle -->
<button
	id="sidebar-toggle"
	class="fixed left-4 top-4 z-50 p-2 bg-[#202123] rounded hover:bg-[#2A2B32] transition-colors"
	aria-label="Toggle sidebar">
	<svg
		xmlns="http://www.w3.org/2000/svg"
		class="h-5 w-5"
		fill="none"
		viewBox="0 0 24 24"
		stroke="currentColor">
		<path
			stroke-linecap="round"
			stroke-linejoin="round"
			stroke-width="2"
			d="M4 6h16M4 12h16M4 18h16" />
	</svg>
</button>

{% include "chat/sidebar.html" %}

<div id="main-content"
	class="transition-all duration-300 ease-in-out min-h-screen">
	{% if current_chat.id %}
	<div class="fixed right-2 top-2 mb-2">
		<button id="quiz-button"
			class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors font-semibold shadow">
			Quiz
		</button>
	</div>
	{% endif %}

	<div class="mx-auto pt-14 pb-4 px-2 sm:px-4 max-w-3xl">
		<!-- Quiz button (only show if not a new chat) -->
		<!-- Mobile header -->
		<div
			class="md:hidden flex items-center justify-center p-2 mb-4 text-center">
			<h1 class="text-lg font-medium truncate max-w-[250px]">
				{% if current_chat.title %}{{ current_chat.title }}{% else %}New
				Chat{% endif %}
			</h1>
		</div>
		{% include "chat/messages.html" %}
		{% include "chat/chat_input.html" %}
	</div>
</div>
<script id="chat-config" type="application/json">
	{"currentChatId": "{{ current_chat.id|default:'new' }}", "isNewChat": {{ is_new_chat|yesno:'true,false' }}}
</script>
{% endblock %}

{% block extra_js %}
<script src="{% static 'chat/chat.js' %}"></script>
<script src="{% static 'chat/quiz.js' %}"></script>
{% endblock %}
